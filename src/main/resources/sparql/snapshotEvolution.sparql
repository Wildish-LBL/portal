PREFIX roevo: <http://purl.org/wf4ever/roevo#>
PREFIX ro: <http://purl.org/wf4ever/ro#>
PREFIX dcterms: <http://purl.org/dc/terms/>

CONSTRUCT
{
<<<<<<< HEAD
	<%s> roevo:isSnapshotOf ?live ;
		roevo:hasPreviousVersion ?father ;
		dcterms:identifier ?id ;
		dcterms:created ?created ;
		a ?class ;
		a ?type .
	?live dcterms:identifier ?liveid ;
		dcterms:created ?livecreated ;
		a ?liveclass ;
		a ?livetype .
	?son roevo:isSnapshotOf ?live ;
		roevo:hasPreviousVersion <%<s> ;
		dcterms:identifier ?sonid ;
		dcterms:created ?soncreated ;
		a ?sonclass ;
		a ?sontype .
	?grandson roevo:isSnapshotOf ?live ;
		roevo:hasPreviousVersion ?son ;
		dcterms:identifier ?grandsonid ;
		dcterms:created ?grandsoncreated ;
		a ?grandsonclass ;
		a ?grandsontype .
	?father roevo:isSnapshotOf ?live ;
		roevo:hasPreviousVersion ?grandfather ;
		dcterms:identifier ?fatherid ;
		dcterms:created ?fathercreated ;
		a ?fatherclass ;
		a ?fathertype .
	?grandfather roevo:isSnapshotOf ?live ;
		dcterms:identifier ?grandfatherid ;
		dcterms:created ?grandfathercreated ;
		a ?grandfatherclass ;
		a ?grandfathertype .
	?derived roevo:derivedFrom <%<s> ;
		dcterms:identifier ?derivedid ;
		dcterms:created ?derivedcreated ;
		a ?derivedclass ;
		a ?derivedtype .
}
WHERE
{
	OPTIONAL { <%<s> roevo:isSnapshotOf ?live . }
	OPTIONAL { <%<s> dcterms:identifier ?id . }
	OPTIONAL { <%<s> dcterms:created ?created . }
	OPTIONAL { <%<s> a ?class . }
	OPTIONAL { <%<s> dcterms:type ?type . }

	OPTIONAL { ?live dcterms:identifier ?liveid . }
	OPTIONAL { ?live dcterms:created ?livecreated . }
	OPTIONAL { ?live a ?liveclass . }
	OPTIONAL { ?live dcterms:type ?livetype . }

	OPTIONAL
	{
		<%<s> roevo:hasPreviousVersion ?father .
		OPTIONAL { ?father dcterms:identifier ?fatherid . }
		OPTIONAL { ?father dcterms:created ?fathercreated . }
		OPTIONAL { ?father roevo:isSnapshotOf ?live . }
		OPTIONAL { ?father a ?fatherclass . }
		OPTIONAL { ?father dcterms:type ?fathertype . }
		OPTIONAL{
			?father roevo:hasPreviousVersion ?grandfather .
			OPTIONAL { ?grandfather dcterms:identifier ?grandfatherid . }
			OPTIONAL { ?grandfather dcterms:created ?grandfathercreated . }
			OPTIONAL { ?grandfather roevo:isSnapshotOf ?live . }
			OPTIONAL { ?grandfather a ?grandfatherclass . }
			OPTIONAL { ?grandfather dcterms:type ?grandfathertype . }
		}
	}

	OPTIONAL
	{
		?son roevo:hasPreviousVersion <%<s> .
		OPTIONAL { ?son dcterms:identifier ?sonid . }
		OPTIONAL { ?son dcterms:created ?soncreated . }
		OPTIONAL { ?son roevo:isSnapshotOf ?live . }
		OPTIONAL { ?son a ?sonclass . }
		OPTIONAL { ?son dcterms:type ?sontype . }
		OPTIONAL
		{
			?grandson roevo:hasPreviousVersion ?son ;
			OPTIONAL { ?grandson dcterms:identifier ?grandsonid . }
			OPTIONAL { ?grandson dcterms:created ?grandsoncreated . }
			OPTIONAL { ?grandson roevo:isSnapshotOf ?live . }
			OPTIONAL { ?grandson a ?grandsonclass . }
			OPTIONAL { ?grandson dcterms:type ?grandsontype . }
		}
	}

	OPTIONAL
	{
		?derived roevo:derivedFrom <%<s> .
		OPTIONAL { ?derived dcterms:identifier ?derivedid . }
		OPTIONAL { ?derived dcterms:created ?derivedcreated . }
		OPTIONAL { ?derived roevo:isSnapshotOf ?live . }
		OPTIONAL { ?derived a ?derivedclass . }
		OPTIONAL { ?derived dcterms:type ?derivedtype . }
=======
	<%s> roevo:isSnapshotOf ?live .
	?son roevo:isSnapshotOf ?live .
	?grandson roevo:isSnapshotOf ?live .
	?father roevo:isSnapshotOf ?live .
	?grandfather roevo:isSnapshotOf ?live .

	<%s> dcterms:identifier ?id .
	?son dcterms:identifier ?sonid .
	?grandson dcterms:identifier ?grandsonid .
	?father dcterms:identifier ?fatherid .
	?grandfather dcterms:identifier ?grandfatherid .

	<%s> a ro:ResearchObject .
	?son a ro:ResearchObject .
	?grandson a ro:ResearchObject .
	?father a ro:ResearchObject .
	?grandfather a ro:ResearchObject .
		
	?grandson roevo:hasPreviousVersion ?son .
	?son roevo:hasPreviousVersion <%s> .
	<%s> roevo:hasPreviousVersion ?father .
	?father roevo:hasPreviousVersion ?grandfather .

	?derived roevo:derivedFrom <%s> .
	?derived dcterms:identifier ?derivedid .
	?derived a ro:ResearchObject .	
}
WHERE
{
	OPTIONAL
	{
		<%s> roevo:isSnapshotOf ?live .
		<%s> dcterms:identifier ?id .
		<%s> a ro:ResearchObject .
	}

	OPTIONAL
	{
		<%s> roevo:hasPreviousVersion ?father .
		?father dcterms:identifier ?fatherid .
		?father roevo:isSnapshotOf ?live .
		?father a ro:ResearchObject .
		OPTIONAL{
			?father roevo:hasPreviousVersion ?grandfather .
			?grandfather dcterms:identifier ?grandfatherid .
			?grandfather roevo:isSnapshotOf ?live .
			?grandfather a ro:ResearchObject .
		}
	}

	OPTIONAL
	{
		?son roevo:hasPreviousVersion <%s> .
		?son dcterms:identifier ?sonid .
		?son roevo:isSnapshotOf ?live .
		?son a ro:ResearchObject .
		OPTIONAL
		{
			?grandson roevo:hasPreviousVersion ?son .
			?grandson dcterms:identifier ?grandsonid .
			?grandson roevo:isSnapshotOf ?live .
			?grandson a ro:ResearchObject .
		}
	}
	OPTIONAL
	{
		?derived roevo:derivedFrom <%s> .
		?derived dcterms:identifier ?derivedid .
		?derived a ro:ResearchObject .	
>>>>>>> branch 'master' of https://piotrholubowicz@github.com/wf4ever/portal.git
	}
}
